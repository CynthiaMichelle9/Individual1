{% extends "base.html" %}
{% load static %}

{% block title %} Lista de Tareas {% endblock %}


{% block contenido %}
<div class="d-flex justify-content-center">
  <h3>¡Bienvenido a TaskMinder {{ user }} !</h3>
</div>

<div class="card">
  <div class="card-body">
    
    <h3 class="titulo">Lista de tareas</h3>

    <a href="{% url 'crear-tarea'  %}">Añadir tarea</a>
    <div class="col 2">

      <button id="filtro-btn" class="btn-personal">Filtro</button>

<div id="filtro-container" style="display: none;">
  <form method="GET">
    <label for="fecha_vencimiento">Fecha de Vencimiento:</label>
    <select name="fecha_vencimiento" id="fecha_vencimiento">
      <option value="">Todos</option>
      {% for fecha in fechas_vencimiento %}
        <option value="{{ fecha }}">{{ fecha }}</option>
      {% endfor %}
    </select>

    <label for="estado_tarea">Estado:</label>
    <select name="estado_tarea" id="estado_tarea">
      <option value="">Todos</option>
      {% for estado in estados_tarea %}
        <option value="{{ estado }}">{{ estado }}</option>
      {% endfor %}
    </select>

    <label for="titulo">Título:</label>
    <select name="titulo" id="titulo">
      <option value="">Todos</option>
      {% for titulo in titulos %}
        <option value="{{ titulo }}">{{ titulo }}</option>
      {% endfor %}
    </select>

    <label for="etiqueta_tarea">Etiqueta:</label>
    <select name="etiqueta_tarea" id="etiqueta_tarea">
      <option value="">Todos</option>
      {% for etiqueta in etiquetas_tarea %}
        <option value="{{ etiqueta.id }}">{{ etiqueta.nombre }}</option>
      {% endfor %}
    </select>

    <label for="prioridad">Prioridad:</label>
    <select name="prioridad" id="prioridad">
      <option value="">Todas</option>
      {% for p in prioridad %}
      <option value="{{ p.pk }}">{{ p.nombre }}</option>
      {% endfor %}
    </select>

    <button type="submit" class="btn-personal">Filtrar</button>
  </form>
</div>

<script>
  const filtroBtn = document.getElementById('filtro-btn');
  const filtroContainer = document.getElementById('filtro-container');

  filtroBtn.addEventListener('click', () => {
    if (filtroContainer.style.display === 'none') {
      filtroContainer.style.display = 'block';
    } else {
      filtroContainer.style.display = 'none';
    }
  });
</script>


      <table class="table">
        <tr>
          <th>Lista de tareas</th>
          <th>Fecha de vencimiento</th>
          <th>Prioridad</th>
          <th></th>
        </tr>
        {% for tarea in tareas %}
        <tr>
          <td>{{tarea.titulo}}</td><br/>
          <td>{{tarea.fecha_vencimiento}}</td><br/>
          <td>{{tarea.prioridad}}</td><br/>
          <td> <a href="{% url 'tarea' pk=tarea.pk %}">Ver detalles</a></td>
          
        </tr>
      
        {% empty %}
        <p>No hay tareas que mostrar</p>
        {% endfor %}
      </table>
    </div>
  </div>
</div>

{% endblock %}